<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:title" content="ë¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ê³„ì‚°ê¸° - ê·¸ë•Œ ìƒ€ë‹¤ë©´ ì§€ê¸ˆ ì–¼ë§ˆì¼ê¹Œ?" />
  <meta property="og:description" content="ê³¼ê±°ì˜ ë‚˜ë¥¼ ì†Œí™˜ ì¤‘... ê·¸ë•Œ ë¹„íŠ¸ì½”ì¸ ìƒ€ìœ¼ë©´ ì§€ê¸ˆ ì–¼ë§ˆì˜€ì„ê¹Œ?" />
  <title>ë¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ê³„ì‚°ê¸° ğŸ’¸</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: linear-gradient(135deg, #0d0d0d 0%, #1a1a2e 100%);
      color: #fff;
      text-align: center;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 8px;
      background: linear-gradient(45deg, #ff8a00, #ffd257);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 16px;
      opacity: 0.7;
      margin-bottom: 30px;
    }

    .card {
      background: rgba(28, 28, 28, 0.9);
      padding: 24px;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }

    label {
      display: block;
      margin-top: 16px;
      margin-bottom: 8px;
      font-size: 15px;
      text-align: left;
      font-weight: 500;
    }

    .preset-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .preset-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #2a2a2a;
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .preset-btn:hover {
      background: #3a3a3a;
      border-color: #ff8a00;
    }

    .preset-btn.active {
      background: #ff8a00;
      border-color: #ff8a00;
    }

    input[type="date"],
    input[type="number"],
    select {
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      border: 2px solid #333;
      background: #1a1a1a;
      color: #fff;
      font-size: 16px;
      margin-bottom: 12px;
      transition: border-color 0.2s;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #ff8a00;
    }

    .amount-presets {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 8px;
      margin-bottom: 12px;
    }

    .amount-preset {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #2a2a2a;
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .amount-preset:hover {
      background: #3a3a3a;
      border-color: #ff8a00;
    }

    .amount-preset.active {
      background: #ff8a00;
      border-color: #ff8a00;
    }

    button {
      width: 100%;
      padding: 16px;
      font-size: 18px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, #ff8a00, #ff9e28);
      color: white;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(255, 138, 0, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    #result {
      margin-top: 30px;
      padding: 30px;
      background: rgba(26, 26, 26, 0.95);
      border-radius: 20px;
      display: none;
      border: 2px solid rgba(255, 138, 0, 0.3);
    }

    .loading-text {
      font-size: 18px;
      opacity: 0.7;
      font-style: italic;
    }

    .result-main {
      display: none;
    }

    .big-number {
      font-size: 42px;
      font-weight: bold;
      margin: 16px 0;
      color: #ffd257;
      text-shadow: 0 0 20px rgba(255, 210, 87, 0.5);
    }

    .profit-rate {
      font-size: 28px;
      color: #4ade80;
      margin: 12px 0;
      font-weight: bold;
    }

    .regret-text {
      font-size: 18px;
      line-height: 1.6;
      margin: 24px 0;
      padding: 20px;
      background: rgba(255, 138, 0, 0.1);
      border-radius: 12px;
      border-left: 4px solid #ff8a00;
    }

    .comparison {
      margin: 24px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
    }

    .comparison-item {
      margin: 12px 0;
      font-size: 16px;
      opacity: 0.9;
    }

    .comparison-item strong {
      color: #ffd257;
    }

    .what-did-you-do {
      margin: 24px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
    }

    .what-did-you-do select {
      margin-top: 12px;
    }

    .what-did-you-do-result {
      margin-top: 16px;
      font-style: italic;
      color: #ffd257;
      font-size: 16px;
      display: none;
    }

    .share-section {
      margin-top: 30px;
      padding-top: 24px;
      border-top: 1px solid #333;
    }

    .share-title {
      font-size: 18px;
      margin-bottom: 16px;
      opacity: 0.9;
    }

    .share-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .share-btn {
      padding: 12px 24px;
      border-radius: 10px;
      border: none;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .share-btn:hover {
      transform: translateY(-2px);
    }

    .share-btn.kakao {
      background: #FEE500;
      color: #000;
    }

    .share-btn.twitter {
      background: #1DA1F2;
      color: #fff;
    }

    .share-btn.link {
      background: #444;
      color: #fff;
    }

    .stats {
      margin-top: 24px;
      padding: 20px;
      background: rgba(74, 222, 128, 0.1);
      border-radius: 12px;
      border-left: 4px solid #4ade80;
      display: none;
    }

    .stats-title {
      font-size: 16px;
      margin-bottom: 12px;
      color: #4ade80;
    }

    .stats-content {
      font-size: 15px;
      line-height: 1.6;
      opacity: 0.9;
    }

    footer {
      margin-top: 50px;
      font-size: 13px;
      opacity: 0.4;
      padding: 20px;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 24px;
      }

      .big-number {
        font-size: 32px;
      }

      .card {
        padding: 20px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ’¸ ë¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ê³„ì‚°ê¸°</h1>
    <p class="subtitle">ê·¸ë•Œ ìƒ€ë‹¤ë©´ ì§€ê¸ˆ ì–¼ë§ˆì¼ê¹Œ? ê³¼ê±°ì˜ ë‚˜ë¥¼ ì†Œí™˜ ì¤‘...</p>

    <div class="card">
      <label>ì–¸ì œ ì‚´ ìˆ˜ ìˆì—ˆë‚˜? ğŸ“…</label>
      <div class="preset-buttons">
        <button class="preset-btn" onclick="setPresetDate('2017-12-15', '2017ë…„ ë¶ˆì¥ ë•Œ')">2017ë…„ ë¶ˆì¥</button>
        <button class="preset-btn" onclick="setPresetDate('2020-03-12', '2020ë…„ ì½”ë¡œë‚˜ í­ë½ì¥')">2020ë…„ í­ë½ì¥</button>
        <button class="preset-btn" onclick="setPresetDate('2021-11-10', '2021ë…„ ì‹ ê³ ê°€')">2021ë…„ ì‹ ê³ ê°€</button>
        <button class="preset-btn" onclick="setPresetDate('2015-01-01', '2015ë…„ ì´ˆê¸°')">2015ë…„ ì´ˆê¸°</button>
      </div>
      <input type="date" id="dateInput" min="2010-01-01" />

      <label>ê·¸ë•Œ ì–¼ë§ˆ ë„£ì—ˆì„ ìˆ˜ ìˆë‚˜? ğŸ’°</label>
      <div class="amount-presets">
        <div class="amount-preset" onclick="setAmount(100000)">10ë§Œì›</div>
        <div class="amount-preset" onclick="setAmount(500000)">50ë§Œì›</div>
        <div class="amount-preset" onclick="setAmount(1000000)">100ë§Œì›</div>
        <div class="amount-preset" onclick="setAmount(5000000)">500ë§Œì›</div>
        <div class="amount-preset" onclick="setAmount(10000000)">1000ë§Œì›</div>
      </div>
      <input type="number" id="amountInput" placeholder="ì§ì ‘ ì…ë ¥ (ì›)" min="0" />

      <label>ë§¤ìˆ˜ ë°©ì‹ ğŸ“Š</label>
      <select id="buyMode">
        <option value="lump">ë”± í•œ ë²ˆ ë¬¼ëŸ‰ ëª°ë¹µ</option>
        <option value="dca">ë§¤ë‹¬ ë‚˜ëˆ ì„œ ìƒ€ë‹¤ë©´? (ì ë¦½ì‹ DCA)</option>
      </select>

      <div id="dcaOptions" style="display: none;">
        <label>ì ë¦½ ê¸°ê°„ (ê°œì›”)</label>
        <input type="number" id="dcaMonths" placeholder="ì˜ˆ: 12" min="1" max="60" value="12" />
      </div>

      <button onclick="calculate()">ğŸ” ê³„ì‚°í•˜ê¸° - ì¸ìƒì˜ íƒ€ì´ë° í™•ì¸</button>
    </div>

    <div id="result" class="card">
      <div id="loading" class="loading-text">ê³¼ê±°ì˜ ë‚˜ë¥¼ ì†Œí™˜ ì¤‘... ê·¸ë•Œì˜ ë‚˜ëŠ” ì™œ ê·¸ë¬ì„ê¹Œ ë¡œë”© ì¤‘...</div>
      
      <div id="output" class="result-main">
        <h2 style="margin-top: 0;">ê²°ê³¼</h2>
        
        <p style="margin-bottom: 8px; opacity: 0.8;">ì§€ê¸ˆ ê°€ì¹˜</p>
        <div class="big-number" id="nowValue">-</div>
        
        <p style="margin-bottom: 8px; opacity: 0.8;">ìˆ˜ìµë¥ </p>
        <div class="profit-rate" id="profitRate">-</div>
        
        <div class="regret-text">
          <strong>ë‹¹ì‹ ì€ ì´ë•Œ ë¹„íŠ¸ì½”ì¸ì„ ì‚¬ì§€ ì•ŠìŒìœ¼ë¡œì¨<br>
          ì¸ìƒì—ì„œ <span id="profitAmount">-</span>ë¥¼ ë†“ì³¤ìŠµë‹ˆë‹¤.</strong>
        </div>

        <div class="comparison">
          <p style="margin-bottom: 12px; font-weight: 600;">ê·¸ ëˆì´ë©´ ì‚´ ìˆ˜ ìˆì—ˆë˜ ê²ƒë“¤:</p>
          <div class="comparison-item" id="chicken">ì¹˜í‚¨ <strong id="chickenCount">-</strong>ë§ˆë¦¬</div>
          <div class="comparison-item" id="macbook">ë§¥ë¶ í”„ë¡œ <strong id="macbookCount">-</strong>ëŒ€</div>
          <div class="comparison-item" id="flight">ì„œìš¸-ë‰´ìš• ì™•ë³µ <strong id="flightCount">-</strong>ë²ˆ</div>
          <div class="comparison-item" id="apartment">ì„œìš¸ ì•„íŒŒíŠ¸ ì „ì„¸ê¸ˆ <strong id="apartmentText">-</strong></div>
        </div>

        <div class="what-did-you-do">
          <p style="margin-bottom: 12px;">ê·¸ë•Œ ëŒ€ì‹  ì‹¤ì œë¡œ ë­˜ í–ˆë‚˜? ğŸ¤”</p>
          <select id="whatDidYouDo">
            <option value="">ì„ íƒí•˜ì„¸ìš”...</option>
            <option value="chicken">ì¹˜í‚¨ ì‹œì¼œ ë¨¹ì—ˆë‹¤</option>
            <option value="pcbang">PCë°©ì—ì„œ ë¡¤í–ˆë‹¤</option>
            <option value="card">ì¹´ë“œê°’ ë©”ê¾¸ëŠë¼ ëª» ìƒ€ë‹¤</option>
            <option value="savings">ì½”ì¸ ì‚¬ê¸° ì‹«ì–´ì„œ ì˜ˆê¸ˆí–ˆë‹¤</option>
            <option value="nothing">ê·¸ëƒ¥ ë†€ì•˜ë‹¤</option>
          </select>
          <div class="what-did-you-do-result" id="whatDidYouDoResult"></div>
        </div>

        <div class="stats" id="stats">
          <div class="stats-title">ğŸ“Š í†µê³„</div>
          <div class="stats-content" id="statsContent"></div>
        </div>

        <div class="share-section">
          <div class="share-title">ë‚˜ë§Œ ì–µìš¸í•  ìˆ˜ ì—†ë‹¤ ğŸ˜‚ ê³µìœ í•˜ê¸°</div>
          <div class="share-buttons">
            <button class="share-btn kakao" onclick="shareKakao()">
              ğŸ’¬ ì¹´ì¹´ì˜¤í†¡
            </button>
            <button class="share-btn twitter" onclick="shareTwitter()">
              ğŸ¦ íŠ¸ìœ„í„°
            </button>
            <button class="share-btn link" onclick="copyLink()">
              ğŸ“‹ ë§í¬ ë³µì‚¬
            </button>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>Â© 2025 ë¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ì—°êµ¬ì†Œ</p>
      <p style="margin-top: 8px; font-size: 11px;">íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤. ì¸ìƒì˜ íƒ€ì´ë°ì´ ì–¼ë§ˆë‚˜ ì”ì¸í•œì§€ ë³´ì—¬ì£¼ëŠ” ì¬ë¯¸ ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤.</p>
    </footer>
  </div>

  <script>
    const USD_KRW = 1400; // USD â†’ KRW í™˜ìœ¨ (ì‹¤ì œë¡œëŠ” APIì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²Œ ì¢‹ìŒ)
    
    // ë¹„êµ ê¸°ì¤€ ê°€ê²©ë“¤
    const PRICES = {
      chicken: 20000,      // ì¹˜í‚¨ 1ë§ˆë¦¬
      macbook: 3000000,    // ë§¥ë¶ í”„ë¡œ
      flight: 2000000,     // ì„œìš¸-ë‰´ìš• ì™•ë³µ
      apartment: 500000000 // ì„œìš¸ ì•„íŒŒíŠ¸ ì „ì„¸ê¸ˆ (5ì–µ)
    };

    // ë”ë¯¸ í†µê³„ ë°ì´í„° (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²Œ ì¢‹ìŒ)
    const DUMMY_STATS = {
      "20ëŒ€": { avg: 5000000, percentile: 0.15 },
      "30ëŒ€": { avg: 15000000, percentile: 0.12 },
      "40ëŒ€": { avg: 30000000, percentile: 0.08 },
      "50ëŒ€": { avg: 50000000, percentile: 0.05 }
    };

    // í”„ë¦¬ì…‹ ë‚ ì§œ ì„¤ì •
    function setPresetDate(date, label) {
      document.getElementById("dateInput").value = date;
      // í”„ë¦¬ì…‹ ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
      document.querySelectorAll(".preset-btn").forEach(btn => {
        btn.classList.remove("active");
        if (btn.textContent.includes(label.split(" ")[0])) {
          btn.classList.add("active");
        }
      });
    }

    // ê¸ˆì•¡ í”„ë¦¬ì…‹ ì„¤ì •
    function setAmount(amount) {
      document.getElementById("amountInput").value = amount;
      // í”„ë¦¬ì…‹ ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
      document.querySelectorAll(".amount-preset").forEach(btn => {
        btn.classList.remove("active");
        if (btn.textContent.includes((amount / 10000) + "ë§Œì›")) {
          btn.classList.add("active");
        }
      });
    }

    // DCA ì˜µì…˜ í‘œì‹œ/ìˆ¨ê¹€
    document.getElementById("buyMode").addEventListener("change", function() {
      const dcaOptions = document.getElementById("dcaOptions");
      dcaOptions.style.display = this.value === "dca" ? "block" : "none";
    });

    // "ê·¸ë•Œ ëŒ€ì‹  ë­˜ í–ˆë‚˜" ì„ íƒ ì´ë²¤íŠ¸
    document.getElementById("whatDidYouDo").addEventListener("change", function() {
      const resultDiv = document.getElementById("whatDidYouDoResult");
      if (this.value) {
        const messages = {
          chicken: "ê·¸ ì¹˜í‚¨ì´ ì§€ê¸ˆì¯¤ í™©ê¸ˆ ì¹˜í‚¨ì´ ë˜ì–´ ëŒì•„ì™”ì„ í…ë°... ğŸ—",
          pcbang: "ê·¸ ë¡¤ ê²Œì„ì´ ì§€ê¸ˆì¯¤ ë‹¤ì´ì•„ í‹°ì–´ê°€ ë˜ì–´ ëŒì•„ì™”ì„ í…ë°... ğŸ®",
          card: "ê·¸ ì¹´ë“œê°’ì´ ì§€ê¸ˆì¯¤... ì•„ë‹ˆ ì ê¹, ê·¸ê±´ ê·¸ë˜ë„ ë§ëŠ” ì„ íƒì´ì—ˆì„ ìˆ˜ë„... ğŸ’³",
          savings: "ê·¸ ì˜ˆê¸ˆì´ ì§€ê¸ˆì¯¤... ìŒ, ê·¸ë˜ë„ ì•ˆì „í–ˆìœ¼ë‹ˆê¹Œ ê´œì°®ì•„ìš”... ğŸ¦",
          nothing: "ê·¸ ì‹œê°„ì´ ì§€ê¸ˆì¯¤... ì•„ë‹ˆ ì ê¹, ê·¸ëƒ¥ ë†€ì•˜ìœ¼ë©´ ê·¸ëƒ¥ ë†€ì•˜ì§€ ë­... ğŸ˜…"
        };
        resultDiv.textContent = messages[this.value];
        resultDiv.style.display = "block";
      } else {
        resultDiv.style.display = "none";
      }
    });

    // CoinGecko APIë¡œ ê³¼ê±° ê°€ê²© ê°€ì ¸ì˜¤ê¸°
    async function fetchBTCPrice(date) {
      try {
        // CoinGecko APIëŠ” dd-mm-yyyy í˜•ì‹ í•„ìš”
        const dateParts = date.split("-");
        const formattedDate = `${dateParts[2]}-${dateParts[1]}-${dateParts[0]}`;
        const url = `https://api.coingecko.com/api/v3/coins/bitcoin/history?date=${formattedDate}`;
        const response = await fetch(url);
        const data = await response.json();
        return data.market_data?.current_price?.usd ?? null;
      } catch (error) {
        console.error("Error fetching BTC price:", error);
        return null;
      }
    }

    // í˜„ì¬ BTC ê°€ê²© ê°€ì ¸ì˜¤ê¸°
    async function fetchCurrentBTCPrice() {
      try {
        const url = "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd";
        const response = await fetch(url);
        const data = await response.json();
        return data.bitcoin?.usd ?? null;
      } catch (error) {
        console.error("Error fetching current BTC price:", error);
        return null;
      }
    }

    // DCA ê³„ì‚° (ë§¤ë‹¬ íˆ¬ì)
    async function calculateDCA(startDate, monthlyAmount, months) {
      let totalBTC = 0;
      const start = new Date(startDate);
      
      for (let i = 0; i < months; i++) {
        const currentDate = new Date(start);
        currentDate.setMonth(start.getMonth() + i);
        const dateStr = currentDate.toISOString().split("T")[0];
        
        const price = await fetchBTCPrice(dateStr);
        if (price) {
          totalBTC += monthlyAmount / price;
        }
        // API í˜¸ì¶œ ì œí•œì„ í”¼í•˜ê¸° ìœ„í•´ ì•½ê°„ì˜ ë”œë ˆì´
        if (i < months - 1) {
          await new Promise(resolve => setTimeout(resolve, 100));
        }
      }
      
      return totalBTC;
    }

    // ìˆ«ì í¬ë§·íŒ…
    function formatKRW(num) {
      return num.toLocaleString("ko-KR") + "ì›";
    }

    // ë¹„êµ í•­ëª© ê³„ì‚°
    function calculateComparisons(profit) {
      return {
        chicken: Math.floor(profit / PRICES.chicken),
        macbook: Math.floor(profit / PRICES.macbook),
        flight: Math.floor(profit / PRICES.flight),
        apartment: profit >= PRICES.apartment ? "ì¼ë¶€" : "ì—†ìŒ"
      };
    }

    // í†µê³„ ìƒì„±
    function generateStats(profit) {
      // ë”ë¯¸ ë‚˜ì´ëŒ€ (ì‹¤ì œë¡œëŠ” ì‚¬ìš©ì ì…ë ¥ ë˜ëŠ” ì¶”ì •)
      const ageGroup = "30ëŒ€";
      const stats = DUMMY_STATS[ageGroup];
      
      const percentile = profit > stats.avg * 2 ? stats.percentile * 0.5 : stats.percentile;
      const percentileText = Math.floor(percentile * 100);
      
      return `ë‹¹ì‹  ë˜ë˜(${ageGroup})ì˜ í‰ê·  'ë†“ì¹œ ëˆ'ì€ ${formatKRW(stats.avg)}ì…ë‹ˆë‹¤.\në‹¹ì‹ ì€ ê·¸ ì¤‘ ìƒìœ„ ${percentileText}% ìˆ˜ì¤€ìœ¼ë¡œ ë§ì´ ë†“ì³¤ìŠµë‹ˆë‹¤. ğŸ˜­`;
    }

    // ë©”ì¸ ê³„ì‚° í•¨ìˆ˜
    async function calculate() {
      const dateInput = document.getElementById("dateInput").value;
      const amount = Number(document.getElementById("amountInput").value);
      const buyMode = document.getElementById("buyMode").value;
      const dcaMonths = Number(document.getElementById("dcaMonths").value) || 12;

      if (!dateInput || !amount || amount <= 0) {
        alert("ë‚ ì§œì™€ ê¸ˆì•¡ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ˜…");
        return;
      }

      // ê²°ê³¼ ì˜ì—­ í‘œì‹œ
      document.getElementById("result").style.display = "block";
      document.getElementById("loading").style.display = "block";
      document.getElementById("output").classList.remove("result-main");
      document.getElementById("output").style.display = "none";

      try {
        let btcAmount;
        let btcPast;

        if (buyMode === "lump") {
          // ì¼ì‹œ ë§¤ìˆ˜
          btcPast = await fetchBTCPrice(dateInput);
          if (!btcPast) {
            alert("í•´ë‹¹ ë‚ ì§œì˜ ê°€ê²© ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤! ğŸ˜¢");
            document.getElementById("loading").style.display = "none";
            return;
          }
          btcAmount = amount / btcPast;
        } else {
          // DCA ì ë¦½ì‹
          const monthlyAmount = amount / dcaMonths;
          btcAmount = await calculateDCA(dateInput, monthlyAmount, dcaMonths);
          // í‰ê·  ê°€ê²© ê³„ì‚° (ëŒ€ëµì ìœ¼ë¡œ)
          btcPast = amount / btcAmount;
        }

        const btcNow = await fetchCurrentBTCPrice();
        if (!btcNow) {
          alert("í˜„ì¬ ê°€ê²©ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤! ğŸ˜¢");
          document.getElementById("loading").style.display = "none";
          return;
        }

        const nowValue = btcAmount * btcNow * USD_KRW;
        const profit = nowValue - amount;
        const profitRate = ((nowValue / amount - 1) * 100).toFixed(1);

        // ê²°ê³¼ í‘œì‹œ
        document.getElementById("nowValue").innerText = formatKRW(Math.floor(nowValue));
        document.getElementById("profitRate").innerText = `+${profitRate}%`;
        document.getElementById("profitAmount").innerText = formatKRW(Math.floor(profit));

        // ë¹„êµ í•­ëª© í‘œì‹œ
        const comparisons = calculateComparisons(profit);
        document.getElementById("chickenCount").textContent = comparisons.chicken;
        document.getElementById("macbookCount").textContent = comparisons.macbook;
        document.getElementById("flightCount").textContent = comparisons.flight;
        document.getElementById("apartmentText").textContent = comparisons.apartment;

        // í†µê³„ í‘œì‹œ
        const statsContent = generateStats(profit);
        document.getElementById("statsContent").textContent = statsContent;
        document.getElementById("stats").style.display = "block";

        // ê²°ê³¼ ì €ì¥ (ê³µìœ ìš©)
        window.calculationResult = {
          date: dateInput,
          amount: amount,
          nowValue: nowValue,
          profit: profit,
          profitRate: profitRate
        };

        // ë¡œë”© ìˆ¨ê¸°ê³  ê²°ê³¼ í‘œì‹œ
        document.getElementById("loading").style.display = "none";
        document.getElementById("output").style.display = "block";
        document.getElementById("output").classList.add("result-main");

        // ê²°ê³¼ë¡œ ìŠ¤í¬ë¡¤
        document.getElementById("result").scrollIntoView({ behavior: "smooth", block: "start" });

      } catch (error) {
        console.error("Calculation error:", error);
        alert("ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤! ğŸ˜¢");
        document.getElementById("loading").style.display = "none";
      }
    }

    // ê³µìœ  í•¨ìˆ˜ë“¤
    function shareKakao() {
      if (!window.calculationResult) {
        alert("ë¨¼ì € ê³„ì‚°ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”!");
        return;
      }

      const { date, amount, nowValue, profit } = window.calculationResult;
      const text = `${date}ì— ${formatKRW(amount)}ë§Œ ë¹„íŠ¸ì½”ì¸ ìƒ€ìœ¼ë©´ ì§€ê¸ˆ ${formatKRW(Math.floor(nowValue))}ì˜€ëŒ€... ë‚˜ ëŒ€ì‹  ìš¸ì–´ì¤„ ì‚¬ëŒ... ğŸ˜­\n\në†“ì¹œ ìˆ˜ìµ: ${formatKRW(Math.floor(profit))}\n\në¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ê³„ì‚°ê¸°: ${window.location.href}`;

      // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  (ì‹¤ì œë¡œëŠ” ì¹´ì¹´ì˜¤ SDK í•„ìš”)
      if (navigator.share) {
        navigator.share({
          title: "ë¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ê³„ì‚°ê¸°",
          text: text,
          url: window.location.href
        }).catch(() => {
          copyToClipboard(text);
        });
      } else {
        copyToClipboard(text);
        alert("ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”! ğŸ’¬");
      }
    }

    function shareTwitter() {
      if (!window.calculationResult) {
        alert("ë¨¼ì € ê³„ì‚°ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”!");
        return;
      }

      const { date, amount, nowValue, profit } = window.calculationResult;
      const text = `${date}ì— ${formatKRW(amount)}ë§Œ ë¹„íŠ¸ì½”ì¸ ìƒ€ìœ¼ë©´ ì§€ê¸ˆ ${formatKRW(Math.floor(nowValue))}ì˜€ëŒ€... ğŸ˜­\n\në¹„íŠ¸ì½”ì¸ ì•ˆ ì‚° ì£„ ê³„ì‚°ê¸°`;
      const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(window.location.href)}`;
      window.open(url, "_blank");
    }

    function copyLink() {
      const url = window.location.href;
      copyToClipboard(url);
      alert("ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“‹");
    }

    function copyToClipboard(text) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text);
      } else {
        // Fallback
        const textarea = document.createElement("textarea");
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand("copy");
        document.body.removeChild(textarea);
      }
    }
  </script>
</body>
</html>
